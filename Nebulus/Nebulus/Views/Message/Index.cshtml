@using DayPilot.Web.Mvc
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using GridMvc.Html
@using Nebulus.Models
@model IEnumerable<MessageItem>

<br />

@Html.DayPilotMonth("dp", new DayPilotMonthConfig
{
    BackendUrl = Url.Content("~/Message/Backend"),
    EventClickHandling = DayPilot.Web.Mvc.Events.Month.EventClickHandlingType.CallBack,
    TimeRangeSelectedHandling = DayPilot.Web.Mvc.Events.Month.TimeRangeSelectedHandlingType.CallBack,  
})

<br />

<div class="tip">
<select id="dropdown">
    @{ for (var d = DateTime.Today; d < DateTime.Today.AddMonths(15); d = d.AddMonths(1))
     {
        <option value="@d.ToString("s")">@d.ToString("MMMM yyyy")</option>
     }}
</select>
</div>

<br />

<div class="row">
    <p><a href="~/Message/Create" class="btn btn-default">Create Message &raquo;</a></p>
</div>

<br />

@Html.Grid(Model).Columns(columns =>
{
    columns.Add(item => item.MessageTitle).Titled("Title");
    columns.Add().RenderValueAs(o => Enum.Parse(typeof(MessagePriorityType), o.MessagePriority.ToString()).ToString()).Titled("Priority");
    columns.Add(item => item.ScheduleStart.LocalDateTime).Titled("Start Time");
    columns.Add(item => item.ScheduleInterval).Titled("Interval");
    columns.Add(item => item.Expiration.LocalDateTime).Titled("Expiration");
    columns.Add().Encoded(false).Sanitized(false).SetWidth(30).RenderValueAs(o => @Html.ActionLink("Edit", "Edit", new { id = o.MessageItemId }, new { @class = "btn btn-default  btn-xs" }));
    columns.Add().Encoded(false).Sanitized(false).SetWidth(30).RenderValueAs(o => @Html.ActionLink("Delete", "Delete", new { id = o.MessageItemId }, new { @class = "btn btn-default  btn-xs" }));
    columns.Add().Encoded(false).Sanitized(false).RenderValueAs(o => @Html.ActionLink("Send Now", "Send", o, new { @class = "btn btn-default  btn-xs" }));
})

<script type="text/javascript">
    $("#dropdown").change(function () {
        var selected = $(this).val();
        dp.commandCallBack("navigate", { start: selected });
    });
</script>











